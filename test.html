<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Online Test System</title>
    <style>
        body {
            font-family: "Times New Roman", Times, serif;
            background-color: #f4f4f4;
            color: #333;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
        }

        .test-container {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 600px;
        }

        h1 {
            text-align: center;
            margin-bottom: 20px;
        }

        .status-bar {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            font-weight: bold;
        }

        .question {
            margin-bottom: 20px;
            font-size: 18px;
            font-weight: bold;
        }

        .question-box {
            background-color: #e0e0e0;
            border: 1px solid #ccc;
            border-radius: 5px;
            padding: 10px;
            margin-bottom: 20px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .options {
            list-style-type: none;
            padding: 0;
        }

        .options li {
            margin-bottom: 10px;
        }

        .options input[type="checkbox"] {
            margin-right: 10px;
        }

        .option-A {
            background-color: #f8d7da; /* Light red */
        }

        .option-B {
            background-color: #d1ecf1; /* Light blue */
        }

        .option-C {
            background-color: #d4edda; /* Light green */
        }

        .option-D {
            background-color: #fff3cd; /* Light yellow */
        }

        #result {
            text-align: center;
            margin-top: 20px;
            font-size: 18px;
        }

        #next-btn {
            display: none;
            margin-top: 20px;
            width: 100%;
            padding: 10px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }

        #next-btn:hover {
            background-color: #0056b3;
        }

        #restart-btn {
            display: none;
            margin-top: 20px;
            width: 100%;
            padding: 10px;
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }

        #restart-btn:hover {
            background-color: #218838;
        }

        .notification {
            position: fixed;
            top: 10px;
            right: 10px;
            padding: 10px;
            border-radius: 5px;
            color: white;
            font-weight: bold;
            opacity: 0;
            transition: opacity 0.5s;
        }

        .notification.success {
            background-color: #28a745;
        }

        .notification.error {
            background-color: #dc3545;
        }

        .notification.show {
            opacity: 1;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>Online Test</h1>
        <div class="status-bar">
            <div id="score-banner">Score: 0</div>
            <div id="questions-left">Questions Left: 0</div>
        </div>
        <div id="question-container"></div>
        <div id="result"></div>
        <button id="next-btn">Next Question</button>
        <button id="restart-btn" onclick="restartExam()">Restart Exam</button>
    </div>

    <script>
        let questions = [];
        let answers = {};
        let score = 0;
        let currentQuestionIndex = 0;

        async function loadQuestionsAndAnswers() {
            try {
                const questionsResponse = await fetch('Image/question.txt');
                const questionsText = await questionsResponse.text();
                questions = parseQuestions(questionsText);

                const answersResponse = await fetch('Image/answer.txt');
                answers = await answersResponse.json();

                loadQuestion();
            } catch (error) {
                console.error('Error loading questions or answers:', error);
            }
        }

        function parseQuestions(text) {
            const lines = text.split('\n').filter(line => line.trim() !== '');
            const parsedQuestions = [];
            let question = null;

            lines.forEach(line => {
                if (line.startsWith('1.') || line.startsWith('2.') || line.startsWith('3.')) {
                    if (question) {
                        parsedQuestions.push(question);
                    }
                    question = { question: line.split('. ')[1], options: [], correctAnswer: '' };
                } else if (line.startsWith('A)') || line.startsWith('B)') || line.startsWith('C)') || line.startsWith('D)')) {
                    const option = line.split(') ')[1];
                    question.options.push(option);
                }
            });

            if (question) {
                parsedQuestions.push(question);
            }

            return parsedQuestions;
        }

        function loadQuestion() {
            const questionContainer = document.getElementById("question-container");
            questionContainer.innerHTML = "";
            const currentQuestion = questions[currentQuestionIndex];

            const questionElement = document.createElement("div");
            questionElement.classList.add("question-box");

            const questionTitle = document.createElement("div");
            questionTitle.classList.add("question");
            questionTitle.textContent = `Q${currentQuestionIndex + 1}: ${currentQuestion.question}`;
            questionElement.appendChild(questionTitle);

            const optionsList = document.createElement("ul");
            optionsList.classList.add("options");

            currentQuestion.options.forEach((option, index) => {
                const optionElement = document.createElement("li");
                const label = document.createElement("label");
                const checkbox = document.createElement("input");
                checkbox.type = "checkbox";
                checkbox.name = "option";
                checkbox.value = String.fromCharCode(65 + index); // A, B, C, D
                checkbox.disabled = true; // Initially disable checkboxes

                const colors = ['option-A', 'option-B', 'option-C', 'option-D'];
                label.classList.add(colors[index]);

                checkbox.onclick = () => checkAnswer(index);
                label.appendChild(checkbox);
                label.append(option);
                optionElement.appendChild(label);
                optionsList.appendChild(optionElement);
            });

            questionElement.appendChild(optionsList);
            questionContainer.appendChild(questionElement);

            document.getElementById("questions-left").textContent = `Questions Left: ${questions.length - currentQuestionIndex}`;
        }

        function checkAnswer(selectedIndex) {
            const currentQuestion = questions[currentQuestionIndex];
            const correctAnswer = answers[String(currentQuestionIndex + 1)];
            const resultElement = document.getElementById("result");

            const options = document.getElementsByName("option");
            let isCorrect = false;

            options.forEach((option, index) => {
                const label = option.parentElement;
                if (option.value === correctAnswer) {
                    label.style.border = "2px solid green";
                    label.style.backgroundColor = "#d4edda"; // Light green for correct
                    if (index === selectedIndex) {
                        isCorrect = true;
                        resultElement.textContent = "Correct!";
                        resultElement.style.color = "green";
                        showNotification("Correct", "success");
                    }
                } else {
                    if (index === selectedIndex) {
                        label.style.border = "2px solid red";
                        label.style.backgroundColor = "#f8d7da"; // Light red for incorrect
                        resultElement.textContent = `Incorrect! Correct answer: ${currentQuestion.options[answers[String(currentQuestionIndex + 1)].charCodeAt(0) - 65]}`;
                        resultElement.style.color = "red";
                        showNotification("Incorrect", "error");
                    }
                }
                option.disabled = true; // Disable all options after selection
            });

            if (isCorrect) {
                score++;
                document.getElementById("score-banner").textContent = `Score: ${score}`;
            }

            document.getElementById("next-btn").style.display = "block"; // Show next button
        }

        function showNotification(message, type) {
            const notification = document.createElement("div");
            notification.className = `notification ${type}`;
            notification.textContent = message;
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.classList.add("show");
                setTimeout(() => {
                    notification.classList.remove("show");
                    setTimeout(() => notification.remove(), 500);
                }, 2000);
            }, 100);
        }

        function loadNextQuestion() {
            currentQuestionIndex++;
            if (currentQuestionIndex < questions.length) {
                loadQuestion();
                document.getElementById("next-btn").style.display = "none"; // Hide next button
            } else {
                showFinalResult();
            }
        }

        function showFinalResult() {
            document.getElementById("question-container").innerHTML = "";
            document.getElementById("result").textContent = `Exam has ended. You have scored ${score} out of ${questions.length}.`;
            document.getElementById("result").style.color = "#333";
            document.getElementById("restart-btn").style.display = "block";
        }

        function restartExam() {
            currentQuestionIndex = 0;
            score = 0;
            document.getElementById("restart-btn").style.display = "none";
            document.getElementById("questions-left").style.display = "block";
            document.getElementById("result").textContent = "";
            document.getElementById("score-banner").textContent = "Score: 0";
            loadQuestionsAndAnswers();
        }

        document.getElementById("next-btn").addEventListener("click", loadNextQuestion);

        loadQuestionsAndAnswers();
    </script>
</body>
</html>
